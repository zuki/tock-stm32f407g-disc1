<!DOCTYPE HTML>
<html lang="en" class="sidebar-visible no-js light">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>GPIO - Tockドキュメント</title>
        
        


        <!-- Custom HTML head -->
        


        <meta content="text/html; charset=utf-8" http-equiv="Content-Type">
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff" />

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        
        <link rel="stylesheet" href="../fonts/fonts.css">
        

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        

        
    </head>
    <body>
        <!-- Provide site root to javascript -->
        <script type="text/javascript">
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>

        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script type="text/javascript">
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script type="text/javascript">
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            var html = document.querySelector('html');
            html.classList.remove('no-js')
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add('js');
        </script>

        <!-- Hide / unhide sidebar before it is displayed -->
        <script type="text/javascript">
            var html = document.querySelector('html');
            var sidebar = 'hidden';
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            }
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <div class="sidebar-scrollbox">
                <ol class="chapter"><li class="chapter-item expanded "><a href="../Overview.html"><strong aria-hidden="true">1.</strong> Tockの概要</a></li><li class="chapter-item expanded "><a href="../Design.html"><strong aria-hidden="true">2.</strong> Tockの設計</a></li><li class="chapter-item expanded "><a href="../threat_model/index.html"><strong aria-hidden="true">3.</strong> Threat Model</a></li><li class="chapter-item expanded affix "><li class="part-title">Tockの実装</li><li class="chapter-item expanded "><a href="../Lifetimes.html"><strong aria-hidden="true">4.</strong> ライフタイム</a></li><li class="chapter-item expanded "><a href="../Mutable_References.html"><strong aria-hidden="true">5.</strong> 可変参照</a></li><li class="chapter-item expanded "><a href="../Soundness.html"><strong aria-hidden="true">6.</strong> 安全性</a></li><li class="chapter-item expanded "><a href="../Compilation.html"><strong aria-hidden="true">7.</strong> コンパイル</a></li><li class="chapter-item expanded "><a href="../TockBinaryFormat.html"><strong aria-hidden="true">8.</strong> TBF: Tockバイナリフォーマット</a></li><li class="chapter-item expanded "><a href="../Memory_Layout.html"><strong aria-hidden="true">9.</strong> メモリレイアウト</a></li><li class="chapter-item expanded "><a href="../Memory_Isolation.html"><strong aria-hidden="true">10.</strong> メモリ隔離</a></li><li class="chapter-item expanded "><a href="../Registers.html"><strong aria-hidden="true">11.</strong> レジスタ</a></li><li class="chapter-item expanded "><a href="../Startup.html"><strong aria-hidden="true">12.</strong> 起動</a></li><li class="chapter-item expanded "><a href="../Syscalls.html"><strong aria-hidden="true">13.</strong> システムコール</a></li><li class="chapter-item expanded "><a href="../Userland.html"><strong aria-hidden="true">14.</strong> ユーザランド</a></li><li class="chapter-item expanded "><a href="../Networking_Stack.html"><strong aria-hidden="true">15.</strong> Networking Stack</a></li><li class="chapter-item expanded "><a href="../Configuration.html"><strong aria-hidden="true">16.</strong> 構成</a></li><li class="chapter-item expanded affix "><li class="part-title">インターフェースの詳細</li><li class="chapter-item expanded "><a href="../syscalls/index.html"><strong aria-hidden="true">17.</strong> システムコールインターフェース</a></li><li><ol class="section"><li class="chapter-item expanded "><strong aria-hidden="true">17.1.</strong> コアカーネル提供</li><li><ol class="section"><li class="chapter-item expanded "><a href="../syscalls/memop.html"><strong aria-hidden="true">17.1.1.</strong> memop</a></li></ol></li><li class="chapter-item expanded "><strong aria-hidden="true">17.2.</strong> カプセル提供</li><li><ol class="section"><li class="chapter-item expanded "><a href="../syscalls/00000_alarm.html"><strong aria-hidden="true">17.2.1.</strong> Alarm</a></li><li class="chapter-item expanded "><a href="../syscalls/00001_console.html"><strong aria-hidden="true">17.2.2.</strong> Console</a></li><li class="chapter-item expanded "><a href="../syscalls/00002_leds.html"><strong aria-hidden="true">17.2.3.</strong> LED</a></li><li class="chapter-item expanded "><a href="../syscalls/00003_buttons.html"><strong aria-hidden="true">17.2.4.</strong> Button</a></li><li class="chapter-item expanded "><a href="../syscalls/00004_gpio.html" class="active"><strong aria-hidden="true">17.2.5.</strong> GPIO</a></li><li class="chapter-item expanded "><a href="../syscalls/00005_adc.html"><strong aria-hidden="true">17.2.6.</strong> ADC</a></li><li class="chapter-item expanded "><a href="../syscalls/00007_analog_comparator.html"><strong aria-hidden="true">17.2.7.</strong> AnalogComparator</a></li><li class="chapter-item expanded "><a href="../syscalls/00008_low_level_debug.html"><strong aria-hidden="true">17.2.8.</strong> Low-Level Debug</a></li><li class="chapter-item expanded "><a href="../syscalls/30002_udp.html"><strong aria-hidden="true">17.2.9.</strong> UDP</a></li><li class="chapter-item expanded "><a href="../syscalls/60000_ambient_temperature.html"><strong aria-hidden="true">17.2.10.</strong> Ambient Temp</a></li><li class="chapter-item expanded "><a href="../syscalls/60001_humidity.html"><strong aria-hidden="true">17.2.11.</strong> Humidity</a></li><li class="chapter-item expanded "><a href="../syscalls/60002_luminance.html"><strong aria-hidden="true">17.2.12.</strong> Luminance</a></li><li class="chapter-item expanded "><a href="../syscalls/70005_l3gd20.html"><strong aria-hidden="true">17.2.13.</strong> L3GD20</a></li><li class="chapter-item expanded "><a href="../syscalls/70006_lsm303dlhc.html"><strong aria-hidden="true">17.2.14.</strong> LSM303DLHC</a></li><li class="chapter-item expanded "><a href="../syscalls/80005_hd44780.html"><strong aria-hidden="true">17.2.15.</strong> HD44780</a></li></ol></li></ol></li><li class="chapter-item expanded "><a href="../reference/index.html"><strong aria-hidden="true">18.</strong> Internal Kernel Interfaces</a></li><li><ol class="section"><li class="chapter-item expanded "><a href="../reference/trd1-trds.html"><strong aria-hidden="true">18.1.</strong> TRD 1: Tock Reference</a></li><li class="chapter-item expanded "><a href="../reference/trd102-adc.html"><strong aria-hidden="true">18.2.</strong> TRD 102: ADC</a></li></ol></li><li class="chapter-item expanded "><li class="part-title">Tockのセットアップと使用法</li><li class="chapter-item expanded "><a href="../Getting_Started.html"><strong aria-hidden="true">19.</strong> Getting Started</a></li><li class="chapter-item expanded "><a href="../Porting.html"><strong aria-hidden="true">20.</strong> Tockのポーティング</a></li><li class="chapter-item expanded "><a href="../OutOfTree.html"><strong aria-hidden="true">21.</strong> ツリー外のボード</a></li><li class="chapter-item expanded "><a href="../debugging/index.html"><strong aria-hidden="true">22.</strong> Debugging Help</a></li><li class="chapter-item expanded "><a href="../Style.html"><strong aria-hidden="true">23.</strong> Style</a></li><li class="chapter-item expanded affix "><li class="part-title">Management of Tock</li><li class="chapter-item expanded "><a href="../wg/index.html"><strong aria-hidden="true">24.</strong> Working Groups</a></li><li class="chapter-item expanded "><a href="../CodeReview.html"><strong aria-hidden="true">25.</strong> Code Review Process</a></li></ol>
            </div>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle"></div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky bordered">
                    <div class="left-buttons">
                        <button id="sidebar-toggle" class="icon-button" type="button" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </button>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light (default)</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                        
                    </div>

                    <h1 class="menu-title">Tockドキュメント</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>
                        
                    </div>
                </div>

                
                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" name="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>
                

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script type="text/javascript">
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <hr />
<h2><a class="header" href="#driver-number-0x00004" id="driver-number-0x00004">driver number: <code>0x00004</code></a></h2>
<h1><a class="header" href="#gpio" id="gpio">GPIO</a></h1>
<h2><a class="header" href="#overview" id="overview">Overview</a></h2>
<p>The GPIO driver allows userspace to synchronously control the output and
receive callbacks on changes in the input for a set of GPIO pins.</p>
<p>This is a low-level GPIO driver designed to export &quot;hardware-like&quot; control
of GPIO pins to userspace. Not all platforms will expose all or even any
pins using this interface to userspace.</p>
<p><em>Unstable:</em> As this is a low-level interface, the mapping of GPIO pins
is currently unstable and unspecified. Users of this driver must consult
their board for a mapping from pin identifiers used in this driver to
actual hardware pins. This mapping is currently subject to change.</p>
<h2><a class="header" href="#command" id="command">Command</a></h2>
<ul>
<li>
<h3><a class="header" href="#command-number-0" id="command-number-0">Command number: <code>0</code></a></h3>
<p><strong>Description</strong>: Whether GPIO pins are exported by this board.</p>
<p><strong>Argument 1</strong>: unused</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: <em>Unstable:</em> Most boards return the number of GPIO pins
available, however users should consult their board for details of
this return value.
<code>ENODEVICE</code> if this driver is not present on the board.</p>
</li>
<li>
<h3><a class="header" href="#command-number-1" id="command-number-1">Command number: <code>1</code></a></h3>
<p><strong>Description</strong>: Enable output on a GPIO pin. After enabling output,
output-related operations on the pin (<code>set</code>, <code>clear</code>, <code>toggle</code>) are
available. Using input operations on a pin in this state is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to enable output for.</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: SUCCESS if the command was successful, and <code>EINVAL</code> if the
argument refers to a non-existent pin.</p>
</li>
<li>
<h3><a class="header" href="#command-number-2" id="command-number-2">Command number: <code>2</code></a></h3>
<p><strong>Description</strong>: Set the output of a GPIO pin (high). Using this command
without first enabling output is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to set.</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: <code>SUCCESS</code> if the pin identifier is valid, <code>EINVAL</code> otherwise.</p>
</li>
<li>
<h3><a class="header" href="#command-number-3" id="command-number-3">Command number: <code>3</code></a></h3>
<p><strong>Description</strong>: Clear the output of a GPIO pin (low). Using this command
without first enabling output is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to clear.</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: <code>SUCCESS</code> if the pin identifier is valid, <code>EINVAL</code> otherwise.</p>
</li>
<li>
<h3><a class="header" href="#command-number-4" id="command-number-4">Command number: <code>4</code></a></h3>
<p><strong>Description</strong>: Toggle the output of a GPIO pin. If the pin was
previously high, this operation clears it. If it was previously low, sets
it. Using this command without first enabling output is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to toggle.</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: <code>SUCCESS</code> if the pin identifier is valid, <code>EINVAL</code> otherwise.</p>
</li>
<li>
<h3><a class="header" href="#command-number-5" id="command-number-5">Command number: <code>5</code></a></h3>
<p><strong>Description</strong>: Enable and configure input on a GPIO pin. After enabling
input, input-related operations on the pin (e.g. <code>read</code>) are available.
Using output operations on a pin in this state is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to toggle.</p>
<p><strong>Argument 2</strong>: requested resistor to attach to the pin: <code>0</code> for pull-none,
<code>1</code> for pull-up, or <code>2</code> for pull-down. Other values are undefined.</p>
<p><strong>Returns</strong>: <code>SUCCESS</code> if the pin identifier is valid, <code>EINVAL</code> if it is
invalid, and <code>ENOSUPPORT</code> if the resistor configuration is not supported by
the hardware. If any error is returned, no state will be changed.</p>
</li>
<li>
<h3><a class="header" href="#command-number-6" id="command-number-6">Command number: <code>6</code></a></h3>
<p><strong>Description</strong>: Read the current value of a GPIO pin.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to read.</p>
<p><strong>Argument 2</strong>: unused</p>
<p><strong>Returns</strong>: <code>EINVAL</code> if the identifier of the pin is invalid, <code>1</code> if the
value of the pin is high or <code>0</code> if it is low.</p>
</li>
<li>
<h3><a class="header" href="#command-number-7" id="command-number-7">Command number: <code>7</code></a></h3>
<p><strong>Description</strong>: Configure interrupts on a GPIO pin.
After enabling interrupts, the callback set in subscribe will be called
when the pin level changes.
Using this command without first enabling input is undefined.</p>
<p><strong>Argument 1</strong>: The identifier of the GPIO pin to read.</p>
<p><strong>Argument 2</strong>: Indicates which events trigger callbacks: <code>0</code> for either
edge, <code>1</code> for rising edge, or <code>2</code> for falling edge. Other values are
undefined.</p>
<p><strong>Returns</strong>: <code>SUCCESS</code> if the pin identifier is valid, <code>EINVAL</code> if it is
invalid, and <code>ENOSUPPORT</code> if an invalid interrupt mode is passed in the
configuration field of the argument. If any error is returned, no state
will be changed.</p>
</li>
</ul>
<h2><a class="header" href="#subscribe" id="subscribe">Subscribe</a></h2>
<ul>
<li>
<h3><a class="header" href="#subscribe-number-0" id="subscribe-number-0">Subscribe number: <code>0</code></a></h3>
<p><strong>Description</strong>: Subscribe a callback that will fire when any GPIO pin whose
interrupts have been enabled changes level. Registering the callback does
not have an effect on whether any GPIO pin interrupts are enabled.</p>
<p><strong>Callback signature</strong>: The callback receives two arguments. The first is
the identifier of the GPIO pin whose level has changed, and the second is
the value of the pin when the interrupt occurred. The second argument has
the same semantics as the return value for the <code>read</code> command: <code>0</code> for low,
<code>1</code> for high.</p>
<p><strong>Returns</strong>: SUCCESS if the subscribe was successful, ENOMEM if the driver
cannot support another app, and <code>EINVAL</code> if the app is somehow invalid.</p>
</li>
</ul>
<h2><a class="header" href="#allow" id="allow">Allow</a></h2>
<p>Unused for the GPIO driver. Will always return <code>ENOSUPPORT</code>.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                        
                            <a rel="prev" href="../syscalls/00003_buttons.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>
                        

                        
                            <a rel="next" href="../syscalls/00005_adc.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>
                        

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                
                    <a rel="prev" href="../syscalls/00003_buttons.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>
                

                
                    <a rel="next" href="../syscalls/00005_adc.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
                
            </nav>

        </div>

        

        

        

        
        <script type="text/javascript">
            window.playground_copyable = true;
        </script>
        

        

        
        <script src="../elasticlunr.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../mark.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../searcher.js" type="text/javascript" charset="utf-8"></script>
        

        <script src="../clipboard.min.js" type="text/javascript" charset="utf-8"></script>
        <script src="../highlight.js" type="text/javascript" charset="utf-8"></script>
        <script src="../book.js" type="text/javascript" charset="utf-8"></script>

        <!-- Custom JS scripts -->
        

        

    </body>
</html>
